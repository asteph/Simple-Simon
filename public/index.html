<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Simple Simon</title>
	<link rel="stylesheet" href="/css/simple_simon.css">
</head>
<body>
	<main>
		<h1>Simple Simon</h1>
		<div id="gamebody">
			<div id="0"class="button styling green"></div>
			<div id="1"class="button styling red"></div>
			<button id="start" type='button' class="styling"><h3>PLAY!</h3></button>
			<div id="2"class="button styling yellow"></div>
			<div id="3"class="button styling blue"></div>
		</div>
	</main>
	<audio id="gameOver">
	  <source src="game-over.wav" type="audio/wav">
	</audio>
	<audio id="buttonBeep">
	  <source src="tone-beep.wav" type="audio/wav">
	</audio>
	<script src="//code.jquery.com/jquery-1.11.3.min.js"></script>
	<script type="text/javascript">
	  	"use strict";
	  	//set up randomSequence that will be generated by getRandom
	  	var randomSequence = [];
	  	//set up audio for game over sound
		var playGameOver = function(){ 
			document.getElementById("gameOver").play(); 
		};
		//set up audio for beep on each button
		var playButtonBeep = function(){ 
			document.getElementById("buttonBeep").play(); 
		}; 
		//random function gets a random button and pushes that to the array
		var getRandom = function(){
			var buttons = $('.button'); 	
			var random = Math.floor(Math.random() * 4);
			randomSequence.push(random);
		};	
		//on click,lights up the button and then fades it back out
		var blink = function(target){
			$(target).addClass('buttonDown');
			playButtonBeep();
			$(target).fadeTo('fast', 1, function(){
				$(target).fadeTo('fast', 0.5);
				$(target).removeClass('buttonDown');
		  	});
		};

		//cycles through the randomSequence array and blinks each corresponding div
	  	var blinkArray = function(){
	  		var time = 650;
  			var buttons = $('.button');
	  		$.each(randomSequence, function(i, buttonNumber){
	  			setTimeout(function(){
	  				blink($(buttons[buttonNumber]));
					}, time);
  				time += 650;
	  		});
	  	};
	  	//generate random value stored in randomSequence array and animate
  		$('#start').click(function(){
  			$('#start').addClass('buttonDown');
  			randomSequence = [];
  			getRandom();
  			blinkArray();
  			var counter = 0;
		  	//check value of button clicked to the array value that the user is on
		  	//if they match go to the next number and check to see if last number
		  	//if last number reset counter, add another blink to random and display
			$('.button').on('click',function() {
				blink($(this));
				if (parseInt($(this).attr('id')) == randomSequence[counter]){
					counter += 1;
					if(counter == randomSequence.length){
						$('h3').html('Round<br>' + (counter + 1));
						counter = 0;
						getRandom();
						blinkArray();
					}
				}else{
					//turn off buttons
					$('.button').off();
					$('h3').html('Game<br>Over');
					playGameOver();
					setTimeout(function(){
						$('#start').removeClass('buttonDown');
						$('h3').html('Play Again!');
					}, 3000);
				}
		  	});
	  	});
	</script>
</body>
</html>